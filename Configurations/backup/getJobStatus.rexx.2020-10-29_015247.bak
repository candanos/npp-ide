/* Rexx */
ADDRESS TSO
Arg Jname Jid srchWord
FilterVal = Jname'('Jid')'
/*        */
Drop St.
X1=OutTrap('St.')
Status FilterVal
Rc1=Rc
X1=OutTrap('OFF')  
JOBSTAT=Strip(St.1)
do Forever
 if Rc1=0 Then Do 
   Stat3=Word(St.1,3)
   Stat4=Word(St.1,4)
   Select
   When Stat3='ON'        Then Leave
   When Stat4='ON'        Then Leave
   When Stat3='EXECUTING' Then NOP
   When Stat4='EXECUTING' Then NOP
   When Stat3='WAITING'   Then NOP
   When Stat4='WAITING'   Then NOP
   OtherWise Exit 1
   End
 End
 Else Exit 1
End
/*          */
Drop JNAME.
Drop line.
Drop isfddname.
JFilter='JOBID'
PROFILE NOPREFIX
RC = Isfcalls(ON)
ADDRESS SDSF
isfprefix = '**'
isfowner = '**'
isffilter = "'"JFilter"'"  " EQ '"Jid"'"
"ISFEXEC H(delayed)"
Do ix=1 To JNAME.0
   "ISFACT H TOKEN('"TOKEN.ix"') PARM(NP ?)"
   Do rg = 1 To isfrows2
      If DDNAME.rg='JESMSGLG' Then Do
        "ISFACT H TOKEN('"TOKEN.rg"') PARM(NP SA)"
        If Rc=0 Then Do
            Do kx=1 To isfddname.0
               ADDRESS MVS
              "EXECIO * DISKR" isfddname.kx "(STEM line. FINIS"
               Do dd=1 To line.0
                  F=Find(line.dd,srchWord)
                  If(F>0) Then Do
                     Res = Word(line.dd,(F+1))
                     Return (Res + 0)
                  End
               End
            End
        End
      End
   End
End
