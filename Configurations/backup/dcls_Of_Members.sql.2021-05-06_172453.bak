SELECT PGMNAME, PRJNAME, MDLTYPE FROM SCDEGISK.MODULS WHERE MDLTYPE = 'COPY' AND PGMNAME IN 
(
SELECT DISTINCT C.COPYNAME FROM SCDEGISK.CPYFIELD C WHERE C.PROGNAME IN (#pgms#) AND C.COPYNAME NOT IN 
(SELECT DISTINCT C.COPYNAME FROM SCDEGISK.CPYFIELD C WHERE C.PROGNAME IN (#antipgms#) )
)