import sys 
import os
import datetime
import shutil
import ebcdic
import pathlib

fileName = "YHKEYBUL.cbl"
sourceDir = r'C:/u/ttg/tfsRepos/mainframe-all-apps/COBOL'
targetDir = r'C:/Cloud/github/bebop-rest/target'


def main():    
    convertFileToEbcdic()
    
def convertFileToEbcdic():
    sourceFile = sourceDir + "/" + fileName
    targetFile = targetDir + "/" + fileName
    with open(sourceFile, 'r', encoding='utf-8') as fi: sourceFileinStr = fi.read()

    fileAsStr = ""
    myGen = ispfLineGenerator(sourceFileinStr)
    line = next(myGen)
    while(len(line) == 80):
        newLine = '      ' + str(line[6:72]) + '        '
        fileAsStr = fileAsStr + newLine
        line = next(myGen)
        
    data = fileAsStr.encode("cp1026")
    "\x0D".join(data) 
    "\x15".join(data)
    with open(targetFile, 'wb') as file: file.write(data)
    
def ispfLineGenerator(string):
    i = 0
    while True:
        yield string[i:i+80]
        i=i+80        


            
    f.close()

if __name__ == '__main__': 
    main()